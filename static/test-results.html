<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nettest Results - Performance History</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #ffffff;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: #00d4ff;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .connection-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .connection-tab {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: #333;
            color: #fff;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .connection-tab:hover {
            background: #555;
        }
        
        .connection-tab.active {
            background: #00d4ff;
            color: #000;
        }
        
        .charts-container {
            margin: 20px 0;
        }
        
        .chart-card {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            border: 1px solid #444;
        }
        
        .chart-card.full-width {
            width: 100%;
        }
        
        .chart-card h3 {
            margin: 0 0 20px 0;
            color: #00d4ff;
            font-size: 18px;
        }
        
        .chart {
            width: 100% !important;
            height: 300px !important;
        }
        
        .ping-chart {
            height: 200px !important;
        }
        
        .results-container {
            margin: 20px 0;
            overflow-x: auto;
        }
        
        #resultsTable {
            width: 100%;
            border-collapse: collapse;
            background: #2a2a2a;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            border: 1px solid #444;
        }
        
        #resultsTable th,
        #resultsTable td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #444;
        }
        
        #resultsTable th {
            background: #333;
            font-weight: 600;
            color: #00d4ff;
        }
        
        #resultsTable td {
            color: #ffffff;
        }
        
        #resultsTable tr:hover {
            background: #3a3a3a;
        }
        
        .commit-hash {
            font-family: monospace;
            background: #444;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            color: #00d4ff;
        }
        
        .commit-message {
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-size: 14px;
            color: #e0e0e0;
        }
        
        .error {
            color: #ff6b6b;
            text-align: center;
            padding: 20px;
            font-weight: bold;
        }
        
        .placeholder-row {
            background-color: rgba(255, 107, 107, 0.1) !important;
            color: #ff6b6b !important;
            font-family: inherit !important;
            font-size: inherit !important;
            font-weight: inherit !important;
        }
        
        .placeholder-row:hover {
            background-color: rgba(255, 107, 107, 0.2) !important;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è tooltip */
        .chartjs-tooltip {
            background: rgba(0, 0, 0, 0.9) !important;
            color: white !important;
            border-radius: 8px !important;
            padding: 12px !important;
            font-family: monospace !important;
            font-size: 13px !important;
            line-height: 1.4 !important;
        }
        
        .chartjs-tooltip .commit-hash {
            color: #00d4ff !important;
            font-weight: bold !important;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #00d4ff;
        }

        .error {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 10px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            position: relative;
        }
        
        .status-indicator {
            position: absolute;
            top: 20px;
            right: 0px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            width: 160px;
            max-width: 160px;
            min-width: 160px;
            z-index: 1000;
        }
        
        .status-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            background: #333;
            border-radius: 8px 8px 0 0;
            transition: background-color 0.3s ease;
        }
        
        .status-header:hover {
            background: #444;
        }
        
        .status-icon {
            margin-right: 8px;
            font-size: 16px;
        }
        
        .status-text {
            flex: 1;
            color: #00d4ff;
            font-weight: 600;
        }
        
        .status-toggle {
            color: #ffffff;
            transition: transform 0.3s ease;
        }
        
        .status-indicator.expanded .status-toggle {
            transform: rotate(180deg);
        }
        
        .status-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: #2a2a2a;
            border-radius: 0 0 8px 8px;
            width: 400px;
            max-width: 400px;
            min-width: 400px;
            position: absolute;
            right: 0;
            top: 100%;
        }
        
        .status-content > div {
            padding: 16px;
            border-top: 1px solid #444;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .status-indicator.expanded .status-content {
            max-height: 300px;
        }
        
        .status-success {
            color: #51cf66;
            background: rgba(81, 207, 102, 0.1);
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .status-warning {
            color: #ffd43b;
            background: rgba(255, 212, 59, 0.1);
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
        }
        
        .status-error {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
        }

        .measurement-details {
            margin-top: 15px;
            padding: 15px;
            background: #333;
            border-radius: 6px;
            border: 1px solid #444;
        }
        
        .measurement-details h4 {
            margin: 0 0 15px 0;
            color: #00d4ff;
            font-size: 14px;
            text-align: center;
        }
        
        .measurement-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 8px 12px;
            background: #2a2a2a;
            border-radius: 4px;
            border: 1px solid #444;
        }
        
        .measurement-row:last-child {
            margin-bottom: 0;
        }
        
        .measurement-row .connection-type {
            font-weight: bold;
            color: #00d4ff;
            min-width: 40px;
        }
        
        .measurement-row .measurement-separator {
            margin: 0 8px;
            color: #666;
            font-weight: bold;
        }
        
        .measurement-row .ping-value,
        .measurement-row .download-value,
        .measurement-row .upload-value {
            font-family: monospace;
            color: #00d4ff;
            min-width: 50px;
            text-align: center;
        }
        
        .measurement-row.missing .ping-value,
        .measurement-row.missing .download-value,
        .measurement-row.missing .upload-value {
            color: #ff6b6b;
        }
        
        .measurement-row.missing {
            background: rgba(255, 107, 107, 0.1);
            border-color: #ff6b6b;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Nettest Performance History</h1>
            <p>Track performance changes from API measurements</p>
            <div class="status-indicator" id="statusIndicator">
                <div class="status-header">
                    <span class="status-icon">üìä</span>
                    <span class="status-text" id="statusText">Checking...</span>
                    <span class="status-toggle">‚ñº</span>
                </div>
                <div class="status-content" id="statusContent">
                    <div class="loading">Checking measurement status...</div>
                </div>
            </div>
        </div>

        <div class="connection-tabs">
            <button class="connection-tab active" data-connection="TCP">TCP</button>
            <button class="connection-tab" data-connection="TLS">TLS</button>
            <button class="connection-tab" data-connection="WS">WS</button>
            <button class="connection-tab" data-connection="WSS">WSS</button>
        </div>

        <div class="charts-container">
            <div class="chart-card full-width" id="speeds-chart">
                <h3>üìä Download & Upload Performance</h3>
                <canvas class="chart"></canvas>
            </div>
            <div class="chart-card full-width" id="ping-chart">
                <h3>üìà Ping Latency Trend</h3>
                <canvas class="chart ping-chart"></canvas>
            </div>
        </div>

        <div class="results-table">
            <h3>üìã Test Results History</h3>
            <div class="results-container">
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Commit Hash</th>
                            <th>Commit Message</th>
                            <th>Connection Type</th>
                            <th>Threads</th>
                            <th>Ping (ms)</th>
                            <th>Download (Gbps)</th>
                            <th>Upload (Gbps)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Results will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ Chart.js –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
        if (typeof Chart === 'undefined') {
            console.error('Chart.js not loaded, trying to load from CDN...');
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
            script.onload = () => {
                console.log('Chart.js loaded successfully');
                // –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                if (document.readyState === 'complete') {
                    loadTestResults();
                }
            };
            script.onerror = () => {
                console.error('Failed to load Chart.js from CDN');
            };
            document.head.appendChild(script);
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤
        async function loadTestResults() {
            try {
                console.log('Loading test results...');
                
                // –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ—Ä–µ–Ω–∏–π –∏–∑ API –ø–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–º—É UUID
                const response = await fetch('https://api.nettest.org/reports/basic/history?page=1&size=50&sort=measurementDate%2Cdesc&uuid=ee7760ec-db94-43df-b8dc-001384f0ed40', {
                    headers: {
                        'x-nettest-client': 'nt',
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('API response:', data);
                
                const results = data.content || [];
                console.log('Raw results:', results);
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                const formattedResults = results.map(measurement => {
                    const download = measurement.download ? (measurement.download / 100 / 1000) : 0; // hundredths of Mbps to Gbps
                    const upload = measurement.upload ? (measurement.upload / 100 / 1000) : 0; // hundredths of Mbps to Gbps
                    const ping = measurement.ping ? (measurement.ping / 1000000) : 0; // nanoseconds to milliseconds
                    
                    const formattedResult = {
                        openTestUuid: measurement.openTestUuid || 'N/A',
                        commitHash: measurement.commitHash || null,
                        connectionType: measurement.connectionType || 'N/A',
                        threadsNumber: measurement.threadsNumber || 0,
                        download: download,
                        upload: upload,
                        ping: ping
                    };
                    
                    console.log('Formatted measurement:', formattedResult);
                    return formattedResult;
                });

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
                window.results = formattedResults;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º git –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è commit —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –¥–∞—Ç
                await loadGitHistory(formattedResults);
                
                // –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
                const completeResults = createCompleteResults(formattedResults);
                
                console.log('Complete results before git history:', completeResults.filter(r => r.isPlaceholder).map(r => ({
                    connectionType: r.connectionType,
                    commitHash: r.commitHash,
                    commitDate: r.commitDate
                })));
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º git –∏—Å—Ç–æ—Ä–∏—é –µ—â–µ —Ä–∞–∑ –¥–ª—è placeholder –∑–∞–ø–∏—Å–µ–π
                await loadGitHistory(completeResults);
                
                console.log('Complete results after git history:', completeResults.filter(r => r.isPlaceholder).map(r => ({
                    connectionType: r.connectionType,
                    commitHash: r.commitHash,
                    commitDate: r.commitDate
                })));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å –ø–æ–ª–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
                window.results = completeResults;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä TCP –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ü–ï–†–ï–î –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
                filterByConnection('TCP');
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Å–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
                displayResults(completeResults, 'TCP');
                createCharts(completeResults);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ—Ä–µ–Ω–∏–π
                checkMeasurementStatus();
            } catch (error) {
                console.error('Error loading test results:', error);
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –≤ —Ç–∞–±–ª–∏—Ü–µ
                const tbody = document.querySelector('#resultsTable tbody');
                if (tbody) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7" class="error">
                                Failed to load test results from API: ${error.message}
                            </td>
                        </tr>
                    `;
                }
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º git –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è commit —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –¥–∞—Ç
        async function loadGitHistory(results) {
            try {
                console.log('Loading git history...');
                
                // –ü–æ–ª—É—á–∞–µ–º git –∏—Å—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ GitHub API
                const response = await fetch('https://api.github.com/repos/specure/nettest/commits?per_page=100');
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                
                const commits = await response.json();
                console.log('GitHub commits loaded:', commits.length);
                
                // –°–æ–∑–¥–∞–µ–º map –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ commit —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –¥–∞—Ç –ø–æ SHA
                const commitMap = new Map();
                commits.forEach(commit => {
                    commitMap.set(commit.sha, {
                        message: commit.commit.message,
                        date: commit.commit.author.date
                    });
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º commit —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –¥–∞—Ç—ã –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
                results.forEach(result => {
                    if (result.commitHash && result.commitHash !== 'N/A' && result.commitHash !== null) {
                        // –ò—â–µ–º commit –ø–æ commitHash
                        const commitInfo = commitMap.get(result.commitHash);
                        if (commitInfo) {
                            result.commitMessage = commitInfo.message;
                            result.commitDate = commitInfo.date;
                            if (result.isPlaceholder) {
                                console.log(`Updated placeholder ${result.connectionType} - ${result.commitHash} with date: ${result.commitDate}`);
                            }
                        } else {
                            // –ï—Å–ª–∏ commit –Ω–µ –Ω–∞–π–¥–µ–Ω
                            result.commitMessage = 'Commit not found';
                            result.commitDate = null;
                            if (result.isPlaceholder) {
                                console.log(`Placeholder ${result.connectionType} - ${result.commitHash} not found in git history`);
                            }
                        }
                    } else {
                        // –ó–∞–ø–∏—Å–∏ —Å N/A commitHash –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
                        console.log(`Skipping result with N/A commitHash:`, result);
                    }
                });
                
                console.log('Git history loaded successfully');
            } catch (error) {
                console.error('Error loading git history:', error);
                // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å git –∏—Å—Ç–æ—Ä–∏—é, –∏—Å–ø–æ–ª—å–∑—É–µ–º openTestUuid –∫–∞–∫ –µ—Å—Ç—å
                results.forEach(result => {
                    result.commitMessage = 'Git history unavailable';
                    if (!result.commitHash || result.commitHash === 'N/A' || result.commitHash === null) {
                        result.commitHash = result.openTestUuid;
                    }
                    result.commitDate = null;
                });
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–µ
        function displayResults(results, connectionType = 'TCP') {
            console.log(`Displaying results for ${connectionType}:`, results);
            
            const tbody = document.querySelector('#resultsTable tbody');
            if (!tbody) {
                console.error('Table body not found!');
                return;
            }
            
            tbody.innerHTML = '';
            
            if (!results || results.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="error">
                            No test results found for ${connectionType}
                        </td>
                    </tr>
                `;
                return;
            }
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ connection type –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω
            let displayResults = results;
            if (connectionType !== 'all') {
                displayResults = results.filter(r => r.connectionType === connectionType);
                console.log(`Filtered ${connectionType} results:`, displayResults.length, 'out of', results.length);
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            displayResults.sort((a, b) => {
                const dateA = a.commitDate ? new Date(a.commitDate) : new Date(0);
                const dateB = b.commitDate ? new Date(b.commitDate) : new Date(0);
                return dateB - dateA; // –ù–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É
            });
            
            console.log('Sorted results by date (newest first):', displayResults.map(r => ({
                date: r.commitDate,
                commitHash: r.commitHash,
                connectionType: r.connectionType
            })));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π —Å N/A commitHash –±—ã–ª–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ
            const totalResults = window.results ? window.results.length : 0;
            const validResults = results.filter(r => r.commitHash && r.commitHash !== 'N/A' && r.commitHash !== null).length;
            const excludedResults = totalResults - validResults;
            
            if (excludedResults > 0) {
                console.log(`Excluded ${excludedResults} results with N/A commitHash from display`);
            }
            
            if (displayResults.length === 0) {
                console.log(`No ${connectionType} results found, showing error message`);
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="error">
                            No ${connectionType} test results found
                        </td>
                    </tr>
                `;
                return;
            }
            
            displayResults.forEach((item, index) => {
                const row = document.createElement('tr');
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
                let dateString = 'N/A';
                if (item.commitDate) {
                    try {
                        const date = new Date(item.commitDate);
                        if (!isNaN(date.getTime())) {
                            dateString = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
                        }
                    } catch (e) {
                        console.log('Error parsing date:', item.commitDate, e);
                    }
                }
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è placeholder –∑–∞–ø–∏—Å–µ–π
                const isPlaceholder = item.isPlaceholder;
                
                if (isPlaceholder) {
                    console.log(`Processing placeholder row ${index + 1}:`, {
                        connectionType: item.connectionType,
                        commitHash: item.commitHash,
                        commitDate: item.commitDate,
                        formattedDate: dateString
                    });
                }
                
                row.innerHTML = `
                    <td>${dateString}</td>
                    <td>${(item.commitHash || 'N/A').substring(0, 5)}</td>
                    <td class="commit-message">${item.commitMessage || 'N/A'}</td>
                    <td>${item.connectionType}</td>
                    <td>${isPlaceholder ? '‚Äî' : item.threadsNumber}</td>
                    <td>${isPlaceholder ? '‚Äî' : item.ping.toFixed(2) + ' ms'}</td>
                    <td>${isPlaceholder ? '‚Äî' : item.download.toFixed(2) + ' Gbps'}</td>
                    <td>${isPlaceholder ? '‚Äî' : item.upload.toFixed(2) + ' Gbps'}</td>
                `;
                
                if (isPlaceholder) {
                    row.classList.add('placeholder-row');
                    console.log(`Added placeholder row ${index + 1} for ${item.connectionType} - ${item.commitHash} (date: ${dateString})`);
                } else {
                    console.log(`Added data row ${index + 1}:`, item);
                }
                
                tbody.appendChild(row);
            });
            
            console.log(`Displayed ${displayResults.length} ${connectionType} results in table`);
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', loadTestResults);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
        document.querySelectorAll('.connection-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                filterByConnection(tab.dataset.connection);
            });
        });

        let charts = {
            speeds: null,
            ping: null
        };
        let results = []; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        let currentChartData = []; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤

        function filterByConnection(connectionType) {
            console.log(`Filtering by connection type: ${connectionType}`);
            console.log('Available results:', window.results ? window.results.length : 0);
            console.log('Results with placeholders:', window.results ? window.results.filter(r => r.isPlaceholder).length : 0);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.querySelectorAll('.connection-tab').forEach(tab => {
                if (tab.dataset.connection === connectionType) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–µ
            displayResults(window.results, connectionType);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ —Å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            updateCharts(connectionType);
        }

        function createCharts(results) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ Chart.js –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
            if (typeof Chart === 'undefined') {
                console.error('Chart.js not loaded');
                return;
            }
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ TCP –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏—Å–∫–ª—é—á–∞–µ–º placeholder)
            let filteredResults = results.filter(r => r.connectionType === 'TCP' && !r.isPlaceholder);
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –¥–∞—Ç–µ
            const sortedResults = filteredResults
                .filter(r => r.commitDate)
                .sort((a, b) => new Date(a.commitDate) - new Date(b.commitDate));

            if (sortedResults.length === 0) {
                console.log('No TCP results with dates to create charts');
                return;
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è tooltip
            currentChartData = sortedResults;

            const labels = sortedResults.map(r => {
                const date = new Date(r.commitDate);
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            });

            try {
                console.log('Creating charts with results:', sortedResults);
                console.log('Labels:', labels);
                
                // –ì—Ä–∞—Ñ–∏–∫ —Å–∫–æ—Ä–æ—Å—Ç–µ–π (download + upload)
                const speedsChartElement = document.querySelector('#speeds-chart canvas.chart');
                console.log('Speeds chart element:', speedsChartElement);
                if (speedsChartElement) {
                    const speedsCtx = speedsChartElement.getContext('2d');
                    console.log('Speeds context:', speedsCtx);
                    charts.speeds = new Chart(speedsCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Download (Gbps)',
                                    data: sortedResults.map(r => r.download),
                                    borderColor: '#00d4ff',
                                    backgroundColor: 'rgba(0, 212, 255, 0.1)',
                                    fill: true
                                },
                                {
                                    label: 'Upload (Gbps)',
                                    data: sortedResults.map(r => r.upload),
                                    borderColor: '#ff6b6b',
                                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: '#ffffff'
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false,
                                    backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                    titleColor: '#ffffff',
                                    bodyColor: '#ffffff',
                                    borderColor: '#00d4ff',
                                    borderWidth: 1,
                                    callbacks: {
                                        title: function(context) {
                                            const index = context[0].dataIndex;
                                            const result = currentChartData[index];
                                            if (result && result.commitHash) {
                                                return `Date: ${context[0].label}\nCommit: ${result.commitHash}`;
                                            }
                                            return context[0].label;
                                        },
                                        label: function(context) {
                                            const index = context.dataIndex;
                                            const result = currentChartData[index];
                                            let label = context.dataset.label + ': ' + context.parsed.y.toFixed(2);
                                            if (result && result.connectionType) {
                                                label += ` (${result.connectionType})`;
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        maxRotation: 45,
                                        minRotation: 0,
                                        autoSkip: true,
                                        maxTicksLimit: 20,
                                        color: '#ffffff'
                                    },
                                    grid: {
                                        display: true,
                                        color: '#444'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Speed (Gbps)',
                                        color: '#ffffff'
                                    },
                                    grid: {
                                        display: true,
                                        color: '#444'
                                    },
                                    ticks: {
                                        color: '#ffffff'
                                    }
                                }
                            }
                        }
                    });
                    console.log('Speeds chart created');
                }

                // –ì—Ä–∞—Ñ–∏–∫ –ø–∏–Ω–≥–∞
                const pingChartElement = document.querySelector('#ping-chart canvas.chart');
                console.log('Ping chart element:', pingChartElement);
                if (pingChartElement) {
                    const pingCtx = pingChartElement.getContext('2d');
                    console.log('Ping context:', pingCtx);
                    charts.ping = new Chart(pingCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Ping (ms)',
                                data: sortedResults.map(r => r.ping),
                                borderColor: '#51cf66',
                                backgroundColor: 'rgba(81, 207, 102, 0.1)',
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index'
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        color: '#ffffff'
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false,
                                    backgroundColor: 'rgba(0, 0, 0, 0.9)',
                                    titleColor: '#ffffff',
                                    bodyColor: '#ffffff',
                                    borderColor: '#00d4ff',
                                    borderWidth: 1,
                                    callbacks: {
                                        title: function(context) {
                                            const index = context[0].dataIndex;
                                            const result = currentChartData[index];
                                            if (result && result.commitHash) {
                                                return `Date: ${context[0].label}\nCommit: ${result.commitHash}`;
                                            }
                                            return context[0].label;
                                        },
                                        label: function(context) {
                                            const index = context.dataIndex;
                                            const result = currentChartData[index];
                                            let label = context.dataset.label + ': ' + context.parsed.y.toFixed(2);
                                            if (result && result.connectionType) {
                                                label += ` (${result.connectionType})`;
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: {
                                        maxRotation: 45,
                                        minRotation: 0,
                                        autoSkip: true,
                                        maxTicksLimit: 20,
                                        color: '#ffffff'
                                    },
                                    grid: {
                                        display: true,
                                        color: '#444'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Ping (ms)',
                                        color: '#ffffff'
                                    },
                                    grid: {
                                        display: true,
                                        color: '#444'
                                    },
                                    ticks: {
                                        color: '#ffffff'
                                    }
                                }
                            }
                        }
                    });
                    console.log('Ping chart created');
                }

                console.log('Charts created successfully');
            } catch (error) {
                console.error('Error creating charts:', error);
                console.error('Error details:', error.message);
                console.error('Error stack:', error.stack);
            }
        }

        function updateCharts(connectionType) {
            if (!window.results) return;
            
            let filteredResults = window.results;
            if (connectionType !== 'all') {
                filteredResults = window.results.filter(r => r.connectionType === connectionType && !r.isPlaceholder);
                console.log(`Filtered ${connectionType} results (excluding placeholders):`, filteredResults.map(r => ({
                    connectionType: r.connectionType,
                    commitHash: r.commitHash,
                    download: r.download,
                    upload: r.upload,
                    ping: r.ping
                })));
            }
            
            const sortedFilteredResults = filteredResults
                .filter(r => r.commitDate)
                .sort((a, b) => new Date(a.commitDate) - new Date(b.commitDate));

            if (sortedFilteredResults.length === 0) {
                console.log(`No ${connectionType} results with dates`);
                return;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è tooltip
            currentChartData = sortedFilteredResults;

            const labels = sortedFilteredResults.map(r => {
                const date = new Date(r.commitDate);
                return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
            });

            console.log(`Updating charts with ${sortedFilteredResults.length} data points for ${connectionType}`);

            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ —Å–∫–æ—Ä–æ—Å—Ç–µ–π
            if (charts.speeds) {
                charts.speeds.data.labels = labels;
                charts.speeds.data.datasets[0].data = sortedFilteredResults.map(r => r.download);
                charts.speeds.data.datasets[1].data = sortedFilteredResults.map(r => r.upload);
                charts.speeds.update('none'); // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –ø–∏–Ω–≥–∞
            if (charts.ping) {
                charts.ping.data.labels = labels;
                charts.ping.data.datasets[0].data = sortedFilteredResults.map(r => r.ping);
                charts.ping.update('none'); // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            }
            
            console.log(`Updated charts for connection type: ${connectionType}, data points: ${sortedFilteredResults.length}`);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –≥—Ä–∞—Ñ–∏–∫–∞–º
        function addNewData(newResults) {
            if (!charts.speeds || !charts.ping) return;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
            const allResults = [...window.results, ...newResults];
            window.results = allResults;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏ —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            updateCharts('all');
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∫–æ–º–º–∏—Ç–æ–≤ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
        function createCompleteResults(results) {
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã (–∏—Å–∫–ª—é—á–∞–µ–º N/A –∏ null)
            const uniqueCommits = new Set();
            results.forEach(result => {
                if (result.commitHash && result.commitHash !== 'N/A' && result.commitHash !== null) {
                    uniqueCommits.add(result.commitHash);
                }
            });
            
            console.log('Unique commits found (excluding N/A):', Array.from(uniqueCommits));
            
            // –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
            const connectionTypes = ['TCP', 'TLS', 'WS', 'WSS'];
            const completeResults = [];
            
            uniqueCommits.forEach(commitHash => {
                connectionTypes.forEach(connectionType => {
                    // –ò—â–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ –∏ —Ç–∏–ø–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
                    const existingResult = results.find(r => 
                        r.commitHash === commitHash && 
                        r.connectionType === connectionType
                    );
                    
                    if (existingResult) {
                        // –ï—Å–ª–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ
                        completeResults.push(existingResult);
                    } else {
                        // –ï—Å–ª–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ–º placeholder
                        const placeholderResult = {
                            openTestUuid: 'N/A',
                            commitHash: commitHash,
                            connectionType: connectionType,
                            threadsNumber: 0,
                            download: 0,
                            upload: 0,
                            ping: 0,
                            isPlaceholder: true, // –§–ª–∞–≥ –¥–ª—è placeholder
                            commitDate: null, // –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–∑–∂–µ
                            commitMessage: 'Measurement not available'
                        };
                        completeResults.push(placeholderResult);
                        console.log(`Created placeholder for ${connectionType} - ${commitHash}`);
                    }
                });
            });
            
            // –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å N/A commitHash - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞–µ–º –∏—Ö
            console.log('Excluded results with N/A commitHash:', results.filter(r => !r.commitHash || r.commitHash === 'N/A' || r.commitHash === null).length);
            
            console.log('Complete results created:', completeResults.length, 'entries');
            console.log('Placeholder entries:', completeResults.filter(r => r.isPlaceholder).length);
            console.log('Results with N/A commitHash:', completeResults.filter(r => !r.commitHash || r.commitHash === 'N/A').length);
            return completeResults;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞
        function checkMeasurementStatus() {
            if (!window.results || window.results.length === 0) {
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            const commitsWithDates = window.results
                .filter(r => r.commitDate && !r.isPlaceholder)
                .sort((a, b) => new Date(b.commitDate) - new Date(a.commitDate));
            
            if (commitsWithDates.length === 0) {
                updateStatusIndicator('error', 'No valid commits found');
                return;
            }
            
            // –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç
            const latestCommit = commitsWithDates[0];
            const latestCommitHash = latestCommit.commitHash;
            
            console.log('Checking status for latest commit:', latestCommitHash);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏–π –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
            const connectionTypes = ['TCP', 'TLS', 'WS', 'WSS'];
            const measurementsForLatestCommit = window.results.filter(r => 
                r.commitHash === latestCommitHash && 
                !r.isPlaceholder
            );
            
            console.log('Measurements for latest commit:', measurementsForLatestCommit);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
            const missingConnectionTypes = connectionTypes.filter(connectionType => 
                !measurementsForLatestCommit.some(r => r.connectionType === connectionType)
            );
            
            if (missingConnectionTypes.length > 0) {
                updateStatusIndicator('warning', 
                    `Missing measurements for: ${missingConnectionTypes.join(', ')}`
                );
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏–º–µ—é—Ç –≤–∞–ª–∏–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            const invalidMeasurements = measurementsForLatestCommit.filter(r => 
                r.ping === null || r.ping === undefined || 
                r.download === null || r.download === undefined || 
                r.upload === null || r.upload === undefined
            );
            
            if (invalidMeasurements.length > 0) {
                updateStatusIndicator('warning', 
                    `Invalid measurements for: ${invalidMeasurements.map(r => r.connectionType).join(', ')}`
                );
                return;
            }
            
            // –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã - —Å—Ç–∞—Ç—É—Å —É—Å–ø–µ—à–Ω—ã–π
            updateStatusIndicator('success', 
                `All measurements complete for commit ${latestCommitHash.substring(0, 7)}`
            );
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Å—Ç–∞—Ç—É—Å–∞
        function updateStatusIndicator(status, message) {
            const statusContent = document.getElementById('statusContent');
            const statusText = document.getElementById('statusText');
            const statusIcon = document.querySelector('.status-icon');
            
            let statusClass = '';
            let icon = '';
            let text = '';
            
            switch (status) {
                case 'success':
                    statusClass = 'status-success';
                    icon = '‚úÖ';
                    text = 'Success';
                    break;
                case 'warning':
                    statusClass = 'status-warning';
                    icon = '‚ö†Ô∏è';
                    text = 'Warning';
                    break;
                case 'error':
                    statusClass = 'status-error';
                    icon = '‚ùå';
                    text = 'Failed';
                    break;
                default:
                    statusClass = 'status-error';
                    icon = '‚ùì';
                    text = 'Unknown';
            }
            
            statusIcon.textContent = icon;
            statusText.textContent = text;
            
            // –°–æ–∑–¥–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º —Ç–∏–ø–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
            let detailedContent = `<div class="${statusClass}">${message}</div>`;
            
            if (status === 'success' || status === 'warning') {
                // –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
                const commitsWithDates = window.results
                    .filter(r => r.commitDate && !r.isPlaceholder)
                    .sort((a, b) => new Date(b.commitDate) - new Date(a.commitDate));
                
                if (commitsWithDates.length > 0) {
                    const latestCommitHash = commitsWithDates[0].commitHash;
                    const measurementsForLatestCommit = window.results.filter(r => 
                        r.commitHash === latestCommitHash && 
                        !r.isPlaceholder
                    );
                    
                    if (measurementsForLatestCommit.length > 0) {
                        detailedContent += '<div class="measurement-details">';
                        detailedContent += '<h4>Latest Commit Measurements:</h4>';
                        
                        const connectionTypes = ['TCP', 'TLS', 'WS', 'WSS'];
                        connectionTypes.forEach(connectionType => {
                            const measurement = measurementsForLatestCommit.find(r => r.connectionType === connectionType);
                            if (measurement) {
                                const ping = measurement.ping !== null && measurement.ping !== undefined ? measurement.ping.toFixed(2) : 'N/A';
                                const download = measurement.download !== null && measurement.download !== undefined ? measurement.download.toFixed(2) : 'N/A';
                                const upload = measurement.upload !== null && measurement.upload !== undefined ? measurement.upload.toFixed(2) : 'N/A';
                                
                                detailedContent += `
                                    <div class="measurement-row">
                                        <span class="connection-type">${connectionType}</span>
                                        <span class="measurement-separator">|</span>
                                        <span class="ping-value">${ping}</span>
                                        <span class="measurement-separator">|</span>
                                        <span class="download-value">${download}</span>
                                        <span class="measurement-separator">|</span>
                                        <span class="upload-value">${upload}</span>
                                    </div>
                                `;
                            } else {
                                detailedContent += `
                                    <div class="measurement-row missing">
                                        <span class="connection-type">${connectionType}</span>
                                        <span class="measurement-separator">|</span>
                                        <span class="ping-value">N/A</span>
                                        <span class="measurement-separator">|</span>
                                        <span class="download-value">N/A</span>
                                        <span class="measurement-separator">|</span>
                                        <span class="upload-value">N/A</span>
                                    </div>
                                `;
                            }
                        });
                        
                        detailedContent += '</div>';
                    }
                }
            }
            
            statusContent.innerHTML = detailedContent;
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –ø–ª–∞—à–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            const statusHeader = document.querySelector('.status-header');
            const statusIndicator = document.querySelector('.status-indicator');
            
            if (statusHeader && statusIndicator) {
                statusHeader.addEventListener('click', () => {
                    statusIndicator.classList.toggle('expanded');
                });
            }
        });
    </script>
</body>
</html>
